<div class="flex justify-between items-center gap-2 w-full mb-6">
  <div class="flex justify-center items-center gap-2 w-full bg-[#E0F7E9] py-1 px-3 rounded-md">
    <img src="assets/icons/file.svg" alt="" class="h-6 w-6 ">
    <p class="text-xs text-[#050914]"><span class="text-[#006842]">

        Your profile has been submitted for review.
      </span>
      You will be notified once
      the process is complete or if additional information is required. Meanwhile, you may continue completing your
      profile using the button on the right.</p>
  </div>
  <div class="w-2/6 flex">
    <button type="button"
      class="bg-[#006842] text-white text-sm px-8 py-2 rounded-md hover:bg-secondary hover:text-primary cursor-pointer transition-all font-medium">
      Setup Business Details
    </button>
  </div>
</div>
<form [formGroup]="productsForm" (ngSubmit)="onSubmit()">
  <section class="w-full h-full">
    <!-- header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
      <div class="flex flex-col">
        <h1 class="text-xl font-semibold text-primary">Know Your Business</h1>
        <p class="text-xs text-[#050914]">Complete KYB to avail online payment services</p>
      </div>
      <div class="flex flex-col items-start md:items-center">
        <h1 class="font-normal text-sm text-[#050914]">Company ID</h1>
        <p class="font-normal text-sm text-primary">TRPE0001</p>
      </div>
    </div>
    <hr class="border-[#D2D2D2] my-4" />
    <!-- Contact Info Row -->
    <div class="flex flex-wrap justify-between items-end mt-4 gap-4">
      <div class="flex-1 min-w-[150px]">
        <label class="text-sm text-[#050914]">Contact Person</label>
        <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('contactpersonname')?.value ||
          'Adv.C.P.Chaudhary' }}</p>
      </div>
      <div class="flex-1 min-w-[150px]">
        <label class="text-sm text-[#050914]">Designation</label>
        <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('contactpersondesignation')?.value ||
          'Trusty'
          }}</p>
      </div>
      <div class="flex-1 min-w-[150px]">
        <label class="text-sm text-[#050914]">Mobile</label>
        <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('contactpersonmobile')?.value ||
          '9899092000'}}</p>
      </div>
      <div>
        <button type="button" (click)="openEditDialog(editDialogTemplate)"
          class="bg-[#006842] text-white text-sm px-8 py-2 rounded-md hover:bg-secondary hover:text-primary cursor-pointer transition-all font-semibold">
          Edit
        </button>
      </div>
    </div>
    <hr class="border-[#D2D2D2] my-4" />

    <!-- business details selection -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label class="text-sm text-[#050914]">Business Type</label>
        <p class="text-sm text-[#666666]  font-medium capitalize">{{
          productsForm.get('businesstype')?.value?.replace('-', '/') || 'Trust/Society' }}</p>
      </div>
      <div>
        <label class="text-sm text-[#050914]">GSTIN</label>
        <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('gstin')?.value || '09AAACH7409R1ZZ' }}</p>
      </div>
    </div>
    <div class="mt-8">
      <h1 class="text-sm font-semibold text-primary">Business Details</h1>
      <hr class="border-[#D2D2D2] mt-2 mb-4" />
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label class="text-sm text-[#050914]">
            <span *ngIf="isProprietor() || isPrivatePublicLimited() || isPartnership()">Business Name</span>
            <span *ngIf="isTrustSociety()">Trust/Society Name</span>
          </label>
          <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('businessname')?.value || 'Resident Welfare
            Association Rewari' }}</p>
        </div>
        <div>
          <label class="text-sm text-[#050914]">Registered Address</label>
          <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('registeredaddress')?.value || '1001,
            Sector
            3, Rewari Haryana -123401' }}</p>
        </div>
        <div>
          <label class="text-sm text-[#050914]">
            <span *ngIf="isProprietor()">Proprietor's PAN</span>
            <span *ngIf="isPrivatePublicLimited() || isPartnership()">Company PAN</span>
            <span *ngIf="isTrustSociety()">Trust/Society PAN</span>
          </label>
          <p class="text-sm text-[#666666]  font-medium">{{ productsForm.get('proprietorpan')?.value || 'ADPCH0001' }}
          </p>
        </div>
      </div>
    </div>


    <div class="mt-8">
      <h1 class="text-sm font-semibold text-primary">Upload Documents</h1>
      <hr class="border-[#D2D2D2] mt-2 mb-4" />
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div>
          <label class="text-sm text-[#050914]">Upload Logo</label>
          <div class="mt-2 w-full">
            <button type="button"
              (click)="openPreviewDialog(previewDialogTemplate, imageSrcbottom || productsForm.get('pictureinput')?.value)"
              class="w-full mt-3 bg-[#E5E5E5] text-[#006842] cursor-pointer hover:bg-gray-300 text-sm p-2 rounded-md font-medium">

              Preview File
            </button>
          </div>
        </div>
        <div>
          <label class="text-sm text-[#050914]">Trust/Society's PAN</label>
          <div class="mt-2 w-full">
            <button type="button"
              (click)="openPreviewDialog(previewDialogTemplate, imageSrcbottom1 || productsForm.get('pictureinput1')?.value)"
              class="w-full mt-3 bg-[#E5E5E5] text-[#006842] cursor-pointer hover:bg-gray-300 text-sm p-2 rounded-md font-medium">


              Preview File
            </button>
          </div>
        </div>
        <div>
          <label class="text-sm text-[#050914]">Partnership Deed/LLP Cert.</label>
          <div class="mt-2 w-full">
            <button type="button"
              (click)="openPreviewDialog(previewDialogTemplate, imageSrcbottom2 || productsForm.get('pictureinput2')?.value)"
              class="w-full mt-3 bg-[#E5E5E5] text-[#006842] cursor-pointer hover:bg-gray-300 text-sm p-2 rounded-md font-medium">

              Preview File
            </button>
          </div>
        </div>
        <div>
          <label class="text-sm text-[#050914]">GSTIN Certificate</label>
          <div class="mt-2 w-full">
            <button type="button"
              (click)="openPreviewDialog(previewDialogTemplate, imageSrcbottom3 || productsForm.get('pictureinput3')?.value)"
              class="w-full mt-3 bg-[#E5E5E5] text-[#006842] cursor-pointer hover:bg-gray-300 text-sm p-2 rounded-md font-medium">

              Preview File
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-3">
      <p class="text-sm text-[#4F4F4F]">
        if you want to make any changes contact <a href="mailto:support@example.com"
          class="text-primary hover:underline">support</a>
      </p>
    </div>
  </section>

</form>

<!-- Edit Dialog Template -->
<ng-template #editDialogTemplate>
  <form [formGroup]="productsForm" class="flex flex-col gap-4 py-4">
    <div class="flex flex-col gap-1">
      <label class="text-sm font-medium text-[#050914]">Contact Person</label>
      <input type="text" formControlName="contactpersonname"
        class="w-full px-3 py-2 border border-[#D2D2D2] rounded-md focus:outline-none focus:border-primary text-sm"
        placeholder="Enter contact person name" />
    </div>

    <div class="flex flex-col gap-1">
      <label class="text-sm font-medium text-[#050914]">Designation</label>
      <input type="text" formControlName="contactpersondesignation"
        class="w-full px-3 py-2 border border-[#D2D2D2] rounded-md focus:outline-none focus:border-primary text-sm"
        placeholder="Enter designation" />
    </div>

    <div class="flex flex-col gap-1">
      <label class="text-sm font-medium text-[#050914]">Mobile</label>
      <input type="text" formControlName="contactpersonmobile"
        class="w-full px-3 py-2 border border-[#D2D2D2] rounded-md focus:outline-none focus:border-primary text-sm"
        placeholder="Enter mobile number" />
      <div *ngIf="productsForm.get('contactpersonmobile')?.errors?.['pattern']" class="text-xs text-red-500">
        Please enter a valid 10-digit mobile number
      </div>
    </div>
  </form>
</ng-template>

<!-- Preview Dialog Template -->
<ng-template #previewDialogTemplate>
  <div class="flex flex-col items-center justify-center p-4 min-h-[400px]">
    @if (selectedPreviewUrl) {
    <img [src]="selectedPreviewUrl" class="max-w-full max-h-[70vh] object-contain rounded-lg shadow-lg"
      alt="Document Preview" />
    } @else {
    <div class="text-gray-500 flex flex-col items-center gap-2">
      <z-icon zType="file-text" class="w-12 h-12" />
      <p>No document preview available</p>
    </div>
    }
  </div>
</ng-template>